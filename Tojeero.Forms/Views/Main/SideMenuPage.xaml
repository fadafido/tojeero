<?xml version="1.0" encoding="UTF-8"?>

<common:BasePage
	x:TypeArguments="main:SideMenuViewModel"
	xmlns="http://xamarin.com/schemas/2014/forms"
	xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
	x:Class="Tojeero.Forms.Views.Main.SideMenuPage"
	xmlns:local="clr-namespace:Tojeero.Forms;assembly=Tojeero.Forms"
	xmlns:controls="clr-namespace:ImageCircle.Forms.Plugin.Abstractions;assembly=ImageCircle.Forms.Plugin.Abstractions"
	xmlns:core="clr-namespace:Tojeero.Core;assembly=Tojeero.Core"
	xmlns:converters="clr-namespace:Tojeero.Forms.Converters;assembly=Tojeero.Forms"
	xmlns:markupExtensions="clr-namespace:Tojeero.Forms.Markup_Extensions;assembly=Tojeero.Forms"
	xmlns:common="clr-namespace:Tojeero.Forms.Views.Common;assembly=Tojeero.Forms"
	xmlns:main="clr-namespace:Tojeero.Core.ViewModels.Main;assembly=Tojeero.Core"
	BackgroundColor="{x:Static core:Colors.Main}">
	<ContentPage.Resources>
		<ResourceDictionary>
			<converters:LanguageToCultureConverter
				x:Key="languageCulture" />
		</ResourceDictionary>
	</ContentPage.Resources>
	<ContentPage.Content>
		<StackLayout
			Orientation="Vertical"
			Spacing="0">
			<!--NETWORK AVAILABILITY-->
			<StackLayout
				Padding="0,20,0,5"
				BackgroundColor="{x:Static core:Colors.Orange}"
				IsVisible="{Binding IsNetworkAvailable, Converter={StaticResource inverse}}">
				<Label
					Text="{Binding NoNetworkWarning}"
					TextColor="White"
					FontAttributes="Bold"
					FontSize="Small"
					HorizontalTextAlignment="Center" />
			</StackLayout>
			<!--USER PROFILE-->
			<StackLayout
				Orientation="Vertical"
				VerticalOptions="Start">
				<StackLayout
					Orientation="Vertical"
					Spacing="5"
					Padding="20,30,20,30"
					HeightRequest="120">
					<Grid
						HeightRequest="100"
						WidthRequest="100"
						HorizontalOptions="Center"
						IsVisible="{Binding IsLoggedIn}">
						<Grid.RowDefinitions>
							<RowDefinition
								Height="Auto" />
						</Grid.RowDefinitions>
						<controls:CircleImage
							Source="{x:Static core:Images.ProfilePicturePlaceholder}"
							BorderColor="{x:Static core:Colors.Orange}"
							BorderThickness="5"
							BackgroundColor="Transparent"
							Aspect="AspectFill" />
						<controls:CircleImage
							Source="{Binding CurrentUser.ProfilePictureUrl, Converter={StaticResource cachedImage}}"
							BorderColor="{x:Static core:Colors.MainDark}"
							BorderThickness="5"
							BackgroundColor="Transparent"
							Aspect="AspectFill" />
					</Grid>
					<Label
						Text="{Binding CurrentUser.FullName}"
						HorizontalOptions="Center"
						TextColor="White"
						FontAttributes="Bold" />
				</StackLayout>
			</StackLayout>
			<!--USER OPTIONS-->
			<ScrollView
				BackgroundColor="Transparent"
				VerticalOptions="FillAndExpand">
				<StackLayout
					IsVisible="{Binding IsLoggedIn}">
					<BoxView
						HeightRequest="1"
						HorizontalOptions="FillAndExpand"
						BackgroundColor="{x:Static core:Colors.MainDark}" />
					<!--STORE MANAGEMENT-->
					<Grid
						HorizontalOptions="Start"
						Padding="16,0,0,0"
						HeightRequest="50">
						<StackLayout
							Orientation="Horizontal">
							<Label
								Text="{markupExtensions:Translate MessageLoadingStore}"
								IsVisible="{Binding IsLoadingUserStore}"
								BackgroundColor="Transparent"
								TextColor="{x:Static core:Colors.SideMenuText}"
								VerticalOptions="Center" />
							<ActivityIndicator
								IsRunning="{Binding IsLoadingUserStore}"
								IsVisible="{Binding IsLoadingUserStore}"
								Color="{x:Static core:Colors.SideMenuText}"
								VerticalOptions="Center" />
						</StackLayout>
						<Button
							Text="{Binding ShowSaveStoreTitle}"
							Image="myStoreIcon.png"
							Command="{Binding ShowSaveStoreCommand}"
							TextColor="{x:Static core:Colors.SideMenuText}"
							FontAttributes="Bold"
							IsVisible="{Binding IsShowSaveStoreVisible}"
							BackgroundColor="Transparent"
							HorizontalOptions="Start"
							VerticalOptions="Center" />
						<Button
							HeightRequest="40"
							Text="{markupExtensions:Translate ButtonRefetchStore}"
							Command="{Binding LoadUserStoreCommand}"
							IsEnabled="{Binding CanExecuteLoadUserStoreCommand}"
							TextColor="{x:Static core:Colors.Orange}"
							FontAttributes="Bold"
							IsVisible="{Binding IsLoadingUserStoreFailed}"
							BackgroundColor="Transparent"
							HorizontalOptions="Start"
							VerticalOptions="Center" />
					</Grid>
					<BoxView
						HeightRequest="1"
						HorizontalOptions="FillAndExpand"
						BackgroundColor="{x:Static core:Colors.MainDark}" />
					<StackLayout
						HorizontalOptions="Start"
						HeightRequest="50"
						Padding="16,0,0,0">
						<Button
							HeightRequest="40"
							Text="{markupExtensions:Translate MenuItemProfileSettings}"
							Image="settingsIcon.png"
							Command="{Binding ShowProfileSettingsCommand}"
							TextColor="{x:Static core:Colors.SideMenuText}"
							FontAttributes="Bold"
							BackgroundColor="Transparent"
							HorizontalOptions="Start"
							VerticalOptions="Center" />
					</StackLayout>
					<BoxView
						HeightRequest="1"
						HorizontalOptions="FillAndExpand"
						BackgroundColor="{x:Static core:Colors.MainDark}" />
				</StackLayout>
			</ScrollView>
			<StackLayout
				VerticalOptions="End"
				Spacing="5">
				<StackLayout
					Orientation="Vertical"
					HorizontalOptions="FillAndExpand"
					Spacing="10"
					Padding="10,0,10,0">
					<Label
						Text="Tap the button to change the language to"
						TextColor="#79909d"
						FontAttributes="Bold"
						FontSize="10"
						HorizontalOptions="Center" />
					<Button
						Text="{Binding NewLanguage, Converter={StaticResource languageCulture}}"
						Style="{StaticResource Button3}"
						Command="{Binding ChangeLanguageCommand}"
						VerticalOptions="Center"
						HorizontalOptions="FillAndExpand" />
				</StackLayout>
				<Grid
					Padding="10,10,10,0"
					HeightRequest="50"
					ColumnSpacing="0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition
							Width="*" />
						<ColumnDefinition
							Width="Auto" />
					</Grid.ColumnDefinitions>
					<Button
						Grid.Column="0"
						Text="{markupExtensions:Translate ButtonLogin}"
						Command="{Binding LoginCommand}"
						VerticalOptions="Center"
						Opacity="{Binding IsLoading, Converter={StaticResource inverseOpacity}}"
						Style="{StaticResource Button1}"
						IsEnabled="{Binding CanExecuteLoginCommand}"
						IsVisible="{Binding IsLoggedIn, Converter={StaticResource inverse}}" />
					<Button
						Grid.Column="0"
						Text="{markupExtensions:Translate ButtonLogout}"
						Command="{Binding LogoutCommand}"
						VerticalOptions="Center"
						IsEnabled="{Binding IsLoading, Converter={StaticResource inverse}}"
						Style="{StaticResource Button2}"
						IsVisible="{Binding IsLoggedIn}" />
					<StackLayout
						Grid.Column="1"
						Padding="5,0,5,0"
						VerticalOptions="Center"
						IsVisible="{Binding IsLoading}">
						<ActivityIndicator
							IsRunning="{Binding IsLoading}"
							Color="White" />
					</StackLayout>
				</Grid>
				<Button
					HeightRequest="50"
					Text="{markupExtensions:Translate ButtonTerms}"
					Command="{Binding ShowTermsCommand}"
					TextColor="{x:Static core:Colors.SideMenuText}"
					FontAttributes="Bold"
					BackgroundColor="Transparent"
					HorizontalOptions="Center"
					VerticalOptions="Center" />
			</StackLayout>
		</StackLayout>
	</ContentPage.Content>
</common:BasePage>